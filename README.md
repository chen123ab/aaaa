# aaaa
酒店房间管理
实现功能
服务器：
1、服务器端可以响应多个客户端的请求
2、服务器端可以注册登录
3、登录后可以查看，添加，修改，和删除房间信息
4、记录客户端的预订房间信息
客户端：
1、客户端可以注册登录
2、可以查看房信息（可根据房间价格和类型等查看房间信息）
3、预订房间，而且可以查看订单
4、退房


具体实现
1、服务器与客户端采用tcp协议通信，采用io多路复用的并发服务器实现多客户端的请求响应
2、建立数据库，用来登录注册和存储房间信息

具体步骤
1、搭建大体的框架
2、完成服务器与客户端的搭建，实现两者之间的通信
3、完成数据库的建立，实现服务器端注册登录
4、实现房间信息的增加，修改，删除和查看
5、两端通信，实现客户端发送内容，实现房间信息查看和登记信息
6、测试、运行

通信协议：
酒店管理客户端：
注册：将regiester命令存入buf,用户名存入name，密码存入pwd，然后将命令、用户名、密码通过sprintf函数存入到send_buf中，然后send发送给服务器，等待接受服务器返回信息，如果regiester ok就打印注册成功，rediester error就打印注册失败；
注册成功后，再次进入菜单，选择登录进行登录。
登录：将login命令存入buf,用户名存入name，密码存入pwd，然后将命令、用户名、密码通过sprintf函数存入到send_buf中，然后send发送给服务器，等待接受服务器返回信息，如果login ok就打印登录成功，并进入下个菜单选项，login error就打印登录失败；
登录成功后进入二级菜单
添加：将add命令存入buf,添加信息（如：one-1001-88）存入msg_buf，然后将命令、信息通过sprintf函数存入到send_buf中，然后send发送给服务器，等待接受服务器返回信息，如果add ok就打印添加成功，add error就打印添加失败；
修改：将update命令存入buf,添加信息（如：one-1001-88-未预订）存入msg_buf，然后将命令、信息通过sprintf函数存入到send_buf中，然后send发送给服务器，等待接受服务器返回信息，如果update ok就打印添加成功，update error就打印添加失败；
删除：将delete命令存入buf,添加信息（如：one-1001-88）存入msg_buf，然后将命令、信息通过sprintf函数存入到send_buf中，然后send发送给服务器，等待接受服务器返回信息，如果delete ok就打印添加成功，delete error就打印添加失败；
查看：将look/l_reserve命令存入buf,添加信息（如：one-1001-88）存入msg_buf，然后将命令、信息通过sprintf函数存入到send_buf中，然后send发送给服务器，等待接受服务器返回信息，如ok就输出，error就打印查询失败；
酒店管理商家端：
注册：将regiester命令存入buf,用户名存入name，密码存入pwd，然后将命令、用户名、密码通过sprintf函数存入到send_buf中，然后send发送给服务器，等待接受服务器返回信息，如果regiester ok就打印注册成功，rediester error就打印注	册失败；
登录：将login命令存入buf,用户名存入name，密码存入pwd，然后将命令、用户名、密码通过sprintf函数存入到send_buf中，然后send发送给服务器，等待接受服务器返回信息，如果login ok就打印登录成功，并进入下个菜单选项，login error就打印登录失败；
登录成功后进入二级菜单，
查看房间信息，查看预定，订房间，退房间
查看预定房间，在登录时会存一份用户名，查看预定房间时，根据用户名查找自己对应的预订房间。
订房间时，会存入自己的信息，预订的房间号，
退房间时，只会传对应的命令和房间号



服务器：
注册：用recv接受信息到recv_buf中，然后调用getuserlnFo函数解析内容，比对命令成功后进入注册分支，如果成功就返会regiester ok，失败就register error；
登录：用recv接受信息到recv_buf中，然后调用getuserlnFo函数解析内容，比对命令成功后进入登录分支，如果成功就返会login ok，失败就login` error；
添加：用recv接受信息到recv_buf中，然后调用getuserlnFo函数解析内容，比对命令成功后进入添加分支，如果成功就返会add ok，失败就add error；
修改：用recv接受信息到recv_buf中，然后调用getuserlnFo函数解析内容，比对命令成功后进入修改分支，如果成功就返会update ok，失败就update error；
删除：用recv接受信息到recv_buf中，然后调用getuserlnFo函数解析内容，比对命令成功后进入删除分支，如果成功就返会delete ok，失败就delete error；
查看：用recv接受信息到recv_buf中，然后调用getuserlnFo函数解析内容，比对命令成功后进入对应的查看分支，如果成功就返回查看到的信息， error；
预订房间，调用两个函数，一个用来将订单信息存入reserve表，一个用来修改room表中的预订信息，将未预订修改为已预订。预订时会先在reserve表中查找对应的房间号，如过为查找到才会预订成功。
退房间，同样调用两个函数，一个用来将reserve表中的对应信息删除，一个用来修改room表中的预订信息，将已预订修改为未预订。


遇到的问题：
1、写makefile完成编译时，会有警告说有几个调用的函数未声明
首先，检查了makefile中的头文件路径是否正确，检查编译后还是会有警告，然后将makefile中的有文件路径删除，写入到函数中，还是会有警告，最后在检查头文件时，发现ifndef少打了一个n。
2、在调用函数查看房间信息时，无法将查到的信息发送给客户端。
服务器调用函数后，查到的信息可以在服务器端输出出来，但无法发给客户端，并且在输出完成后，服务器会自动关闭。最后发现，在使用IO多路复用时，将连接返回的套接字以i加入了集合，而在使用for循环发送信息给客户端时，有定义了一个i,导致服务器无法成功发送。
